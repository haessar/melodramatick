{% load static %}
{% load settings %}
{% load notifications_tags %}

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>{% block title %}{% endblock %} | {% settings_value "SITE" %}</title>
  <link rel="shortcut icon" href="{% static 'images/favicon.ico' %}"/>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@ttskch/select2-bootstrap4-theme@1.5.2/dist/select2-bootstrap4.min.css">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-Piv4xVNRyMGpqkS2by6br4gNJ7DXjqk09RmUpJ8jgGtD7zP9yug3goQfGII0yAns" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:wght@300&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script>
    $(document).ready(function() {
      $(document).on('click', '.spotify_link', function() {
        let url = $(this).find("img").attr("uri");
        window.open(url, "_blank");
      });
      $('[data-toggle="tooltip"]').tooltip();
    });
  </script>
  <style>
    th.asc a {
      padding-right: 16px;
      background-repeat: no-repeat;
      background-position: right center;
      background-image: url("{% static 'images/sort_asc.png' %}");
    }

    th.desc a {
      padding-right: 16px;
      background-repeat: no-repeat;
      background-position: right center;
      background-image: url("{% static 'images/sort_desc.png' %}");
    }

    .select2-selection--single {
      padding-bottom: 24px;
    }

    .select2-selection__arrow {
      visibility: hidden;
    }

    .select2-results__options {
      max-height: 250px;
      overflow-y: auto;
    }
  </style>
  {% block head %}{% endblock %}
</head>
<body>
  {% block nav %}
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <a class="navbar-brand" href="#">
        <img src="{% static 'images/banner.png' %}" alt="" class="img-responsive" style="height: 60px;">
      </a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
          {% block nav-home%}
          <li class="nav-item">
            <a class="nav-link" href="{% url 'home' %}">Home</a>
          </li>
          {% endblock %}
          {% if user.is_authenticated %}
            {% block nav-table %}
            <li class="nav-item">
              <a class="nav-link" href="{% url 'work:index' %}">Table</a>
            </li>
            {% endblock %}
            {% block nav-top-list %}
            <li class="nav-item">
              <a class="nav-link" href="{% url 'top_list:index' %}">Top Lists</a>
            </li>
            {% endblock%}
            {% block nav-composers %}
            <li class="nav-item">
              <a class="nav-link" href="{% url 'composer:index' %}">Composers</a>
            </li>
            {% endblock%}
            {% block nav-graphs %}
            <li class="nav-item">
              <a class="nav-link" href="{% url 'work:graphs' %}">Graphs</a>
            </li>
            {% endblock %}
          {% endif %}
          {% block more-links %}{% endblock %}
          {% comment %} <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Dropdown
            </a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
              <a class="dropdown-item" href="#">Action</a>
              <a class="dropdown-item" href="#">Another action</a>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item" href="#">Something else here</a>
            </div>
          </li> {% endcomment %}
          {% comment %} <li class="nav-item">
            <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">Disabled</a>
          </li> {% endcomment %}
        </ul>
        <ul class="navbar-nav ml-auto">
          {% if user.is_authenticated %}
          {% block nav-notifications %}
            {% notifications_unread as unread_count %}
            <li class="nav-item">
              <a class="nav-link" href="{% url 'notifications:unread' %}">
                <i class="fa-solid fa-inbox">{% if unread_count %}{% live_notify_badge badge_class="live_notify_badge badge badge-pill badge-danger" %}{% endif %}</i>
              </a>
            </li>
          {% endblock %}
          {% block nav-profile %}
            <li class="nav-item">
              <a class="nav-link" href="{% url 'profile' user.username %}">Profile</a>
            </li>
          {% endblock %}
          {% block nav-admin %}
            <li class="nav-item">
              {% if user.is_superuser %}
              <a class="nav-link" href="{% url 'admin:index' %}">Admin</a>
              {% else %}
              <a class="nav-link" href="{% url 'user-admin:index' %}">Admin</a>
              {% endif %}
            </li>
            {% endblock %}
            {% block nav-logout %}
            <li class="nav-item">
              <a class="nav-link" href="{% url 'logout' %}">Log Out</a>
            </li>
            {% endblock %}
          {% else %}
            {% block nav-login %}
            <li class="nav-item">
              <a class="nav-link" href="{% url 'login' %}">Log In</a>
            </li>
            {% endblock %}
            {% block nav-signup %}
            <li class="nav-item">
              <a class="nav-link" href="{% url 'signup' %}">Sign Up</a>
            </li>
            {% endblock %}
          {% endif %}
        </ul>
        {% comment %} <form class="form-inline my-2 my-lg-0">
          <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
          <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
        </form> {% endcomment %}
      </div>
    </nav>
  {% endblock %}
  <main>
    <div class="container-fluid pt-2">
      {% if messages %}
        {% for message in messages %}
          <h4 style="color:red; font-family: 'Source Serif Pro', serif;" class="messages"><strong>{{ message }}</strong></h4>
        {% endfor %}
      {% endif %}
      {% block content %}
      {% endblock %}
    </div>
  </main>
  <script src="{% static 'notifications/notify.js' %}" type="text/javascript"></script>
  {% register_notify_callbacks callbacks='fill_notification_list,fill_notification_badge' %}
  <footer class="border-top bd-footer bg-light">
    <div class="container-fluid py-3">
      <p class="text-center">{% settings_value "SITE" %} is a Melodramatick site.</p>
    </div>
  </footer>
</body>
</html>